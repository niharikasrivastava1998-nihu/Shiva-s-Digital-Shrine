<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adiyogi: The Cosmic Ascent</title>
    <style>
        /* --- 1. THEME & FONTS --- */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400&display=swap');

        :root {
            --bg-dark: #050505;
            --stone: #1a1a1a;
            --copper: #c27e48;
            --copper-glow: #ffae6b;
            --water: rgba(189, 218, 255, 0.5);
            --fire-inner: #fff5d6;
            --fire-outer: #ff4500;
            --font-head: 'Cinzel', serif;
            --font-body: 'Lato', sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; background: var(--bg-dark); color: #ddd;
            font-family: var(--font-body); overflow-x: hidden;
        }

        /* --- 2. ENTRANCE OVERLAY --- */
        #entrance-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 1.5s ease;
        }
        .entrance-title {
            font-family: var(--font-head); font-size: 1.5rem; letter-spacing: 4px;
            color: var(--copper); margin-top: 30px; text-transform: uppercase;
            text-align: center;
        }
        .bell-rope { width: 2px; height: 100px; background: #333; margin-bottom: -5px; }
        .bell-svg {
            width: 100px; fill: var(--copper); filter: drop-shadow(0 0 20px var(--copper));
            cursor: pointer; transform-origin: top center;
        }
        .swinging { animation: swing 2s ease-in-out infinite; }
        @keyframes swing { 0% { transform: rotate(10deg); } 50% { transform: rotate(-10deg); } 100% { transform: rotate(10deg); } }

        /* --- 3. MAIN UI LAYOUT --- */
        #main-app { opacity: 0; transition: opacity 1.5s; }

        .shrine-section {
            min-height: 90vh;
            background: radial-gradient(circle at center 60%, #1a1a1a 0%, #000 70%);
            display: flex; flex-direction: column; align-items: center;
            padding-bottom: 20px;
        }

        /* --- 4. SHIVLING ASSEMBLY (Hero) --- */
        .shiva-assembly {
            position: relative; width: 300px; height: 500px;
            display: flex; flex-direction: column; align-items: center;
            margin-top: 20px;
        }

        /* Hanging Pot (SVG) */
        .pot-container { position: relative; width: 100px; height: 100px; z-index: 20; }
        .rope-line { position: absolute; top: -50px; left: 50%; width: 2px; height: 50px; background: #444; }
        .pot-svg { width: 100%; fill: url(#copperGrad); cursor: pointer; transition: transform 0.5s; }
        .pot-svg:hover { transform: rotate(-5deg); }
        
        .water-stream {
            position: absolute; top: 90px; left: 50%; width: 4px; height: 0;
            background: linear-gradient(to bottom, rgba(255,255,255,0.8), var(--water));
            transform: translateX(-50%); transition: height 0.8s ease-in;
            z-index: 15; filter: blur(1px); opacity: 0.8;
        }
        .water-stream.flowing { height: 260px; }

        /* The Lingam (CSS 3D) */
        .lingam {
            width: 120px; height: 180px; margin-top: 60px;
            background: radial-gradient(circle at 30% 30%, #444, #000 85%);
            border-radius: 60px 60px 30px 30px;
            position: relative; z-index: 10;
            box-shadow: inset 5px 5px 20px rgba(255,255,255,0.1), 0 0 50px rgba(0,0,0,0.9);
        }
        .vibhuti-lines { position: absolute; top: 50px; width: 100%; text-align: center; opacity: 0.9; }
        .line { width: 70px; height: 4px; background: #ddd; margin: 4px auto; border-radius: 2px; box-shadow: 0 0 5px white;}
        .bindi { width: 8px; height: 8px; background: red; border-radius: 50%; margin: 5px auto; box-shadow: 0 0 8px red; }

        .yoni {
            width: 240px; height: 70px; background: linear-gradient(to right, #0d0d0d, #222, #0d0d0d);
            border-radius: 100px; margin-top: -30px; position: relative; z-index: 5;
            border: 1px solid #333;
        }
        .yoni-spout {
            position: absolute; right: -40px; bottom: 20px; width: 80px; height: 40px;
            background: #111; transform: rotate(10deg); border-radius: 0 10px 10px 0; z-index: 4;
        }

        /* Diya (Lamp) */
        .diya-container {
            position: absolute; bottom: 50px; cursor: pointer; z-index: 30;
        }
        .diya-svg { width: 80px; fill: #4a3c31; filter: drop-shadow(0 5px 10px #000); }
        .flame {
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%) scale(0);
            width: 15px; height: 30px; background: radial-gradient(ellipse at center, var(--fire-inner), var(--fire-outer));
            border-radius: 50% 50% 20px 20px; transition: transform 0.3s;
            filter: blur(0.5px);
        }
        .flame.lit { transform: translateX(-50%) scale(1); animation: flicker 0.1s infinite alternate; }
        @keyframes flicker { 0% { transform: translateX(-50%) scale(1) skewX(2deg); opacity: 0.9; } 100% { transform: translateX(-50%) scale(1.1) skewX(-2deg); opacity: 1; } }


        /* --- 5. TABS & CONTROLS (Below Lingam) --- */
        .controls-bar {
            width: 100%; background: rgba(10,10,10,0.95);
            border-top: 1px solid #333; padding: 20px 10px;
            display: flex; flex-direction: column; align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .timer-text { font-family: var(--font-head); font-size: 3rem; color: var(--copper); margin-bottom: 15px; }
        
        .nav-tabs { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; width: 100%; max-width: 600px; }
        .nav-btn {
            background: transparent; border: 1px solid #444; color: #888;
            padding: 10px 15px; border-radius: 20px; cursor: pointer;
            font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;
            transition: 0.3s;
        }
        .nav-btn:hover, .nav-btn.active { border-color: var(--copper); color: var(--copper); background: rgba(194,126,72,0.1); }

        /* Dynamic Modules */
        .module-box { width: 100%; max-width: 500px; background: #111; padding: 10px; border-radius: 8px; margin-top: 15px; display: none; border: 1px solid #333; }
        .module-box.show { display: block; animation: slideUp 0.3s; }
        @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        video { width: 100%; border-radius: 5px; transform: scaleX(-1); background: #000; }

        /* --- 6. HIMALAYA PARALLAX (Realistic) --- */
        .mountain-section {
            position: relative; background: #080808; overflow: hidden;
            padding-top: 50px; padding-bottom: 100px; min-height: 120vh;
        }
        
        /* Mist Overlay */
        .mist {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, #000 0%, transparent 20%, transparent 80%, #000 100%);
            z-index: 10; pointer-events: none;
        }

        /* Mountains */
        .mtn { position: absolute; bottom: 0; width: 100%; }
        .mtn-1 { height: 80%; background: #111; clip-path: polygon(0% 100%, 30% 20%, 60% 80%, 80% 30%, 100% 100%); opacity: 0.5; }
        .mtn-2 { height: 50%; background: #161616; clip-path: polygon(0% 100%, 20% 40%, 50% 90%, 80% 50%, 100% 100%); opacity: 0.8; z-index: 2; }
        .mtn-3 { height: 25%; background: linear-gradient(to top, #000, #1c1c1c); clip-path: polygon(0% 100%, 40% 10%, 100% 100%); z-index: 3; opacity: 1; }

        .path-title {
            text-align: center; font-family: var(--font-head); font-size: 2rem; color: #ddd;
            margin-bottom: 60px; position: relative; z-index: 20; text-shadow: 0 0 20px black;
        }

        /* The 7 Steps Journey */
        .steps-container {
            max-width: 600px; margin: 0 auto; position: relative; z-index: 20;
            display: flex; flex-direction: column; gap: 40px; padding: 0 20px;
        }
        .step-unit {
            background: rgba(30, 30, 30, 0.6); border-left: 3px solid var(--copper);
            padding: 20px; border-radius: 0 10px 10px 0; backdrop-filter: blur(5px);
            cursor: pointer; transition: 0.3s;
        }
        .step-unit:hover { background: rgba(50,50,50,0.8); transform: translateX(10px); }
        .s-num { font-family: var(--font-head); font-size: 1.5rem; color: #555; position: absolute; right: 20px; top: 10px; }
        .s-head { color: var(--copper-glow); font-size: 1.1rem; font-weight: bold; text-transform: uppercase; margin-bottom: 5px; }
        .s-body { font-size: 0.9rem; color: #bbb; line-height: 1.5; display: none; margin-top: 10px; border-top: 1px solid #444; padding-top: 10px;}
        .step-unit.active .s-body { display: block; animation: fadeText 0.5s; }
        @keyframes fadeText { from{ opacity:0; } to { opacity:1; } }

    </style>
</head>
<body>

    <svg style="width:0;height:0;position:absolute;">
        <defs>
            <linearGradient id="copperGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#b87333" />
                <stop offset="50%" style="stop-color:#ffce9e" />
                <stop offset="100%" style="stop-color:#5c3a1e" />
            </linearGradient>
        </defs>
    </svg>

    <div id="entrance-screen">
        <div class="bell-rope"></div>
        <svg class="bell-svg swinging" viewBox="0 0 24 24" onclick="enterApp()">
            <path d="M12 2C9.243 2 7 4.243 7 7v7H6c-1.103 0-2 .897-2 2v2c0 1.103.897 2 2 2h5.056c.264 1.706 1.724 3 3.444 3s3.18-1.294 3.444-3H18c1.103 0 2-.897 2-2v-2c0-1.103-.897-2-2-2h-1V7c0-2.757-2.243-5-5-5zm-2 7c0-1.103.897-2 2-2s2 .897 2 2v7h-4V9z"/>
        </svg>
        <div class="entrance-title">Adiyogi<br><span style="font-size: 0.8rem; color: #666; letter-spacing: 2px;">The Cosmic Ascent</span></div>
    </div>

    <div id="main-app">
        
        <div class="shrine-section">
            
            <div class="shiva-assembly">
                <div class="pot-container">
                    <div class="rope-line"></div>
                    <svg class="pot-svg" viewBox="0 0 100 100" onclick="toggleWater()">
                        <path d="M30,0 L70,0 L75,10 C85,15 95,30 95,50 C95,80 75,95 50,95 C25,95 5,80 5,50 C5,30 15,15 25,10 L30,0 Z" />
                    </svg>
                </div>
                <div id="water" class="water-stream"></div>

                <div class="lingam">
                    <div class="vibhuti-lines">
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="line"></div>
                        <div class="bindi"></div>
                    </div>
                </div>
                <div class="yoni">
                    <div class="yoni-spout"></div>
                </div>

                <div class="diya-container" onclick="toggleFire()">
                    <div id="flame" class="flame"></div>
                    <svg class="diya-svg" viewBox="0 0 100 50">
                        <path d="M0,20 Q50,60 100,20 L100,25 Q50,70 0,25 Z" />
                    </svg>
                </div>
            </div>

        </div>

        <div class="controls-bar">
            <div id="timer" class="timer-text">00:00</div>
            
            <div class="nav-tabs">
                <button class="nav-btn" onclick="toggleMeditation(this)">Start Dhyan</button>
                <button class="nav-btn" onclick="toggleWater()">Abhishekam</button>
                <button class="nav-btn" onclick="toggleFire()">Deepam</button>
                <button class="nav-btn" onclick="showModule('spotify')">Sound</button>
                <button class="nav-btn" onclick="showModule('video')">Video</button>
            </div>

            <div id="mod-spotify" class="module-box">
                <p style="color:#666; font-size:0.8rem; margin-bottom:5px;">Shiva Chants (Spotify)</p>
                <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DWXj5e45aU2R2?utm_source=generator&theme=02" width="100%" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
            </div>

            <div id="mod-video" class="module-box">
                <video id="webcam" autoplay muted></video>
                <button class="nav-btn" style="width:100%; border-color:red; color:red; margin-top:5px;" onclick="handleCamera(this)">Start Camera</button>
                <a id="dl-link" style="display:none; color:var(--copper); margin-top:10px; text-align:center;">Download Video</a>
            </div>
        </div>

        <div class="mountain-section">
            <div class="mist"></div>
            <div class="mtn mtn-1"></div>
            <div class="mtn mtn-2"></div>
            <div class="mtn mtn-3"></div>

            <h2 class="path-title">THE 7 STEPS</h2>

            <div class="steps-container">
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">1</div>
                    <div class="s-head">Shravana</div>
                    <div class="s-body">Listening. The first step is to shut the mouth and open the ears of the soul. Listen to the silence behind the noise.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">2</div>
                    <div class="s-head">Manana</div>
                    <div class="s-body">Contemplation. Churning the knowledge. Asking 'Who am I?' until the question dissolves the questioner.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">3</div>
                    <div class="s-head">Nididhyasana</div>
                    <div class="s-body">Meditation. The flow of oil. Unbroken awareness. The observer and observed are distinct but connected.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">4</div>
                    <div class="s-head">Dharana</div>
                    <div class="s-body">Focus. The third eye. Bringing all energies to a single point of fire.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">5</div>
                    <div class="s-head">Dhyana</div>
                    <div class="s-body">Absorption. You do not meditate on Shiva; you become Shiva. The boundaries blur.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">6</div>
                    <div class="s-head">Samadhi</div>
                    <div class="s-body">The Equilibrium. No high, no low. Just pure existence. Sat-Chit-Ananda.</div>
                </div>
                <div class="step-unit" onclick="this.classList.toggle('active')">
                    <div class="s-num">7</div>
                    <div class="s-head">Kaivalya</div>
                    <div class="s-body">Aloneness. Not loneliness, but the realization that you are the All. The drop returns to the Ocean.</div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- AUDIO ENGINE ---
        let audioCtx, waterNode;

        function initAudio() {
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function playBell() {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.value = 200;
            osc.type = 'triangle';
            gain.gain.setValueAtTime(0, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0.5, audioCtx.currentTime + 0.05);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 3);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 3);
        }

        function toggleWaterSound(play) {
            initAudio();
            if(play) {
                if(waterNode) return;
                const bufferSize = 2 * audioCtx.sampleRate;
                const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
                
                const noise = audioCtx.createBufferSource();
                noise.buffer = buffer;
                noise.loop = true;
                const filter = audioCtx.createBiquadFilter();
                filter.type = 'lowpass';
                filter.frequency.value = 400;
                const gain = audioCtx.createGain();
                gain.gain.value = 0.2;
                
                noise.connect(filter); filter.connect(gain); gain.connect(audioCtx.destination);
                noise.start();
                waterNode = { noise, gain };
            } else {
                if(waterNode) {
                    waterNode.noise.stop();
                    waterNode = null;
                }
            }
        }

        // --- UI LOGIC ---

        function enterApp() {
            playBell();
            document.querySelector('.bell-svg').classList.remove('swinging');
            setTimeout(() => {
                document.getElementById('entrance-screen').style.opacity = 0;
                setTimeout(() => {
                    document.getElementById('entrance-screen').style.display = 'none';
                    document.getElementById('main-app').style.opacity = 1;
                }, 1500);
            }, 500);
        }

        function toggleWater() {
            const el = document.getElementById('water');
            if(el.classList.contains('flowing')) {
                el.classList.remove('flowing');
                toggleWaterSound(false);
            } else {
                el.classList.add('flowing');
                toggleWaterSound(true);
            }
        }

        function toggleFire() {
            document.getElementById('flame').classList.toggle('lit');
        }

        function showModule(type) {
            document.querySelectorAll('.module-box').forEach(b => b.classList.remove('show'));
            document.getElementById('mod-' + type).classList.add('show');
        }

        // Timer
        let timerInt;
        let seconds = 0;
        let isRunning = false;
        function toggleMeditation(btn) {
            if(isRunning) {
                clearInterval(timerInt);
                isRunning = false;
                btn.innerText = "Start Dhyan";
                btn.style.borderColor = "#444";
                btn.style.color = "#888";
            } else {
                isRunning = true;
                playBell();
                btn.innerText = "Stop";
                btn.style.borderColor = "var(--copper)";
                btn.style.color = "var(--copper)";
                timerInt = setInterval(() => {
                    seconds++;
                    const m = Math.floor(seconds/60).toString().padStart(2,'0');
                    const s = (seconds%60).toString().padStart(2,'0');
                    document.getElementById('timer').innerText = `${m}:${s}`;
                }, 1000);
            }
        }

        // Camera
        let mediaRecorder;
        let chunks = [];
        async function handleCamera(btn) {
            const vid = document.getElementById('webcam');
            if(btn.innerText === "Start Camera") {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({video:true});
                    vid.srcObject = stream;
                    mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.ondataavailable = e => chunks.push(e.data);
                    mediaRecorder.onstop = e => {
                        const blob = new Blob(chunks, {type:'video/webm'});
                        const url = URL.createObjectURL(blob);
                        const a = document.getElementById('dl-link');
                        a.href = url;
                        a.download = 'meditation.webm';
                        a.style.display = 'block';
                    };
                    mediaRecorder.start();
                    btn.innerText = "Stop Recording";
                } catch(e) { alert("Camera Error"); }
            } else {
                mediaRecorder.stop();
                vid.srcObject.getTracks().forEach(t => t.stop());
                btn.innerText = "Start Camera";
            }
        }

    </script>
</body>
</html>
